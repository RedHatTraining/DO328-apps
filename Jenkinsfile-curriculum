node {
    stage('Check changes') {
        checkout scm
    }

    runIfChanged('adopt-a-pup/web-app/')
}


@NonCPS
def runIfChanged(projectDir) {
  for (changeLogSet in currentBuild.changeSets) {
    for (entry in changeLogSet.getItems()) { // for each commit in the detected changes
      for (file in entry.getAffectedFiles()) {
        if (file.getPath().startsWith(projectDir)) {
            load "$projectDir/Jenkinsfile"
        }
      }
    }
  }
  return false
}